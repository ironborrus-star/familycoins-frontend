# FamilyCoins Frontend

Простое веб-приложение для тестирования API семейного мотивационного приложения FamilyCoins.

## Функционал

### Авторизация
- **Создание семьи** - родитель может создать новую семью и получить код для присоединения
- **Присоединение к семье** - дети и другие родители могут присоединиться по коду

### Для детей
- **Просмотр заданий** - список назначенных заданий
- **Выполнение заданий** - отметка о выполнении с подтверждением
- **Покупки в магазине** - покупка товаров за заработанные монеты
- **Просмотр баланса** - текущий баланс и история транзакций
- **Семья** - информация о членах семьи

### Для родителей
- **Создание заданий** - назначение заданий детям из шаблонов
- **Проверка заданий** - одобрение или отклонение выполненных заданий
- **Управление магазином** - добавление товаров в семейный магазин
- **Корректировка монет** - ручное изменение баланса детей
- **Статистика** - статистика по семье за разные периоды
- **Семья** - управление семьей и просмотр участников

## Запуск

### Требования
- Работающий backend API на http://localhost:8000
- Современный веб-браузер с поддержкой ES6+

### Локальная разработка

1. **Запустите backend сервер:**
   ```bash
   cd backend
   python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
   ```

2. **Настройте конфигурацию frontend:**
   ```bash
   cd frontend
   # Создайте config.js из шаблона
   cp config.js.template config.js
   # Или создайте вручную:
   echo "window.APP_CONFIG = { API_BASE_URL: 'http://localhost:8000' };" > config.js
   ```

3. **Запустите frontend:**
   - **Способ 1: Автоматический запуск (рекомендуется)**
     ```bash
     cd frontend
     python3 start_server.py
     ```
   
   - **Способ 2: Ручной запуск**
     ```bash
     cd frontend
     python3 -m http.server 8080
     ```
   
   - **Способ 3: Docker (как в продакшене)**
     ```bash
     # Из корня проекта
     docker build -f Dockerfile.frontend -t familycoins-frontend .
     docker run -p 8080:80 -e API_BASE_URL=http://localhost:8000 familycoins-frontend
     ```

4. **Откройте в браузере:**
   - При использовании локального сервера: http://localhost:8080
   - При прямом открытии: file:///path/to/frontend/index.html

### Продакшн деплой

Для деплоя на Railway см. [FRONTEND_RAILWAY_DEPLOY.md](../FRONTEND_RAILWAY_DEPLOY.md)

## Тестирование

### Создание семьи
1. Выберите вкладку "Создать семью"
2. Введите название семьи и имя родителя
3. Нажмите "Создать семью"
4. Скопируйте полученный код семьи

### Присоединение к семье
1. Откройте новую вкладку браузера или очистите localStorage
2. Выберите вкладку "Присоединиться"
3. Введите имя, код семьи и выберите роль (ребенок/родитель)
4. Нажмите "Присоединиться"

### Тестирование функций
1. **Создание задания** (родитель):
   - Перейдите в раздел "Задания"
   - Нажмите "Создать задание"
   - Выберите шаблон, детей и настройки
   - Создайте задание

2. **Выполнение задания** (ребенок):
   - Перейдите в раздел "Задания"
   - Найдите назначенное задание
   - Нажмите "Выполнить"
   - Введите подтверждение выполнения

3. **Проверка задания** (родитель):
   - Перейдите в раздел "Задания"
   - Переключитесь на вкладку "Ожидают проверки"
   - Одобрите или отклоните задание

4. **Покупка в магазине** (ребенок):
   - Добавьте товары в магазин (родитель)
   - Перейдите в раздел "Магазин" (ребенок)
   - Купите товар за монеты

## Особенности

### Адаптивность
- Интерфейс адаптируется под мобильные устройства
- На маленьких экранах боковое меню скрывается

### Уведомления
- Toast-уведомления для операций
- Цветная индикация успешных и ошибочных действий

### Роли
- Автоматическое скрытие/показ элементов в зависимости от роли пользователя
- Родители видят функции управления
- Дети видят только доступные им действия

### Сохранение сессии
- Токен авторизации сохраняется в localStorage
- Автоматическое восстановление сессии при перезагрузке

## Структура файлов

```
frontend/
├── index.html          # Основная HTML страница
├── styles.css          # CSS стили
├── app.js             # JavaScript логика
└── README.md          # Документация
```

## API Endpoints

Приложение использует следующие API endpoints:

### Авторизация
- `POST /v1/auth/family/create` - Создание семьи
- `POST /v1/auth/family/join` - Присоединение к семье
- `GET /v1/auth/family/members` - Участники семьи

### Задания
- `GET /v1/tasks/templates` - Шаблоны заданий
- `POST /v1/tasks` - Создание задания
- `GET /v1/tasks/my` - Мои задания
- `PUT /v1/tasks/assignments/{id}/complete` - Выполнение задания
- `PUT /v1/tasks/assignments/{id}/approve` - Проверка задания

### Магазин
- `GET /v1/store/items` - Товары магазина
- `POST /v1/store/items` - Добавление товара
- `POST /v1/store/purchase` - Покупка товара

### Монеты
- `GET /v1/coins/balance` - Баланс монет
- `GET /v1/coins/transactions` - История транзакций
- `POST /v1/coins/adjust` - Корректировка баланса

### Статистика
- `GET /v1/stats/family` - Статистика семьи

## Технологии

- **Vanilla JavaScript** - без внешних фреймворков
- **CSS Grid/Flexbox** - современная верстка
- **Fetch API** - запросы к серверу
- **LocalStorage** - сохранение сессии
- **Font Awesome** - иконки
- **Google Fonts** - типографика

## Возможные проблемы

### CORS
Если backend запущен на другом порту или домене, убедитесь что CORS настроен правильно.

### Локальные файлы
При открытии `index.html` напрямую в браузере могут быть ограничения для fetch запросов. Используйте локальный веб-сервер.

### Кэширование
Браузер может кэшировать файлы. Для сброса кэша используйте Ctrl+F5 или инкогнито режим.

## Дальнейшее развитие

Это базовый frontend для тестирования API. В production версии рекомендуется:

- Использовать фреймворк (React, Vue, Angular)
- Добавить роутинг
- Улучшить валидацию форм
- Добавить больше интерактивности
- Оптимизировать производительность
- Добавить тесты